<!DOCTYPE html>

<head>
  <title>SLR Sign-In</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" />
  <link rel='stylesheet' href='../styles/signUp.css'>
  <!-- BootStrap jQuery -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase.js"></script>
</head>

<body style="margin-top: 4em">

  <form style="border:1px solid #ccc" id="Forum">
    <div class="container" id="SignInBox">

      <h1>Sign In</h1>
      <p>Please fill in this form to create an account.</p>
      <hr>

      <label for="email"><b>Email</b><span id="error"></span></label>
      <input type="text" placeholder="Enter Email" id="email" name="email" required>

      <label for="psw"><b>Password</b></label>
      <input type="password" placeholder="Enter Password" id="passWord" name="password" required>

      <div class="clearfix">
        <!-- <button type="button" class="cancel">Cancel</button> -->
        <button type="submit" class="signIn">Sign In</button>
      </div>
    </div>
  </form>
</body>

<script type='text/javascript'>

  var config = {
    apiKey: "AIzaSyCk_hXhSVW7jWdJrQpTi1I1Nis9J-xv2Tc",
    authDomain: "slr-tj.firebaseapp.com",
    databaseURL: "https://slr-tj.firebaseio.com",
    projectId: "slr-tj",
    storageBucket: "slr-tj.appspot.com",
    messagingSenderId: "389373118412",
    appId: "1:389373118412:web:b50a4c6947157a35d6ff69"
  };

  firebase.initializeApp(config);

  var database = firebase.database();

  var user;

  $(".signIn").on("click", function () {
    event.preventDefault();
    $("#error").text("");

    const email = $("#email")
      .val()
      .trim();
    const password = $("#passWord")
      .val()
      .trim();

    const auth = firebase.auth();

    const promise = auth.signInWithEmailAndPassword(email, password);

    promise.then((result) => {
      // result.user
      // window.location.href = "/home";
    }).catch(e => {
      console.log(e.message);
      $("#error").html("&emsp;&emsp;&emsp;Invalid Username or Password");
    });

    $("#password").val("");
  });

  $(".cancel").on("click", function () {
    window.location.href = "/";
  });

  firebase.auth().onAuthStateChanged(user => {
    if (user) {
      window.location.href = "/home";
    } else {

    }
  });

</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js" async defer></script>
</body>

</html>